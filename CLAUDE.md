# –í–∞–∂–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è Claude

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å—É–±–∞–≥–µ–Ω—Ç–æ–≤ –¥–ª—è —Ç–æ—á–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤
**–í–ê–ñ–ù–û:** –ò—Å–ø–æ–ª—å–∑—É–π —Å—É–±–∞–≥–µ–Ω—Ç—ã Task –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –±–æ–ª–µ–µ —Ç–æ—á–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø—Ä–æ–µ–∫—Ç–µ!

### –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å—É–±–∞–≥–µ–Ω—Ç—ã:
1. **general-purpose** - –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –∞–≥–µ–Ω—Ç –¥–ª—è –ø–æ–∏—Å–∫–∞ –∏ –∞–Ω–∞–ª–∏–∑–∞
   - –ü–æ–∏—Å–∫ —Ñ—É–Ω–∫—Ü–∏–π, –∫–ª–∞—Å—Å–æ–≤, –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
   - –ê–Ω–∞–ª–∏–∑ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø—Ä–æ–µ–∫—Ç–∞
   - –ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å—É–±–∞–≥–µ–Ω—Ç–æ–≤:

#### üîç –ü–æ–∏—Å–∫ –≤ –∫–æ–¥–µ
```
Task (general-purpose): "–ù–∞–π–¥–∏ –≤—Å–µ –º–µ—Å—Ç–∞ –≥–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–æ–¥–µ–ª—å Expense"
Task (general-purpose): "–ì–¥–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –≥–æ–ª–æ—Å–æ–≤—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –±–æ—Ç–µ?"
Task (general-purpose): "–ù–∞–π–¥–∏ –≤—Å–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥ /start"
```

#### üìä –ê–Ω–∞–ª–∏–∑ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã
```
Task (general-purpose): "–ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π —Å—Ç—Ä—É–∫—Ç—É—Ä—É –º–æ–¥–µ–ª–µ–π Django –∏ –∏—Ö —Å–≤—è–∑–∏"
Task (general-purpose): "–ö–∞–∫–∏–µ celery –∑–∞–¥–∞—á–∏ –µ—Å—Ç—å –≤ –ø—Ä–æ–µ–∫—Ç–µ –∏ —á—Ç–æ –æ–Ω–∏ –¥–µ–ª–∞—é—Ç?"
Task (general-purpose): "–ö–∞–∫ –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω–∞ —Ä–∞–±–æ—Ç–∞ —Å AI —Å–µ—Ä–≤–∏—Å–∞–º–∏ (OpenAI/Google)?"
```

#### üîß –ü–æ–∏—Å–∫ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
```
Task (general-purpose): "–ù–∞–π–¥–∏ –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –∏—Å–ø–æ–ª—å–∑—É–µ–º—ã–µ –≤ –ø—Ä–æ–µ–∫—Ç–µ"
Task (general-purpose): "–ö–∞–∫–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –µ—Å—Ç—å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å PDF –æ—Ç—á–µ—Ç–∞–º–∏?"
Task (general-purpose): "–ì–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è Telegram webhook?"
```

#### üêõ –û—Ç–ª–∞–¥–∫–∞ –∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
```
Task (general-purpose): "–ù–∞–π–¥–∏ –≤—Å–µ –º–µ—Å—Ç–∞ –≥–¥–µ –º–æ–∂–µ—Ç –≤–æ–∑–Ω–∏–∫–Ω—É—Ç—å –æ—à–∏–±–∫–∞ —Å –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏"
Task (general-purpose): "–ì–¥–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –æ—à–∏–±–∫–∏ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ —Ç—Ä–∞—Ç?"
Task (general-purpose): "–ù–∞–π–¥–∏ –≤—Å–µ –ª–æ–≥–≥–µ—Ä—ã –∏ —á—Ç–æ –æ–Ω–∏ –ª–æ–≥–∏—Ä—É—é—Ç"
```

#### üìÅ –†–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏ –ø—Ä–æ–µ–∫—Ç–∞
```
Task (general-purpose): "–ö–∞–∫–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π —É –ø—Ä–æ–µ–∫—Ç–∞?"
Task (general-purpose): "–ù–∞–π–¥–∏ –≤—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏ Django –∏ –∏—Ö –ø–æ—Ä—è–¥–æ–∫"
Task (general-purpose): "–ì–¥–µ —Ö—Ä–∞–Ω—è—Ç—Å—è —à–∞–±–ª–æ–Ω—ã –¥–ª—è PDF –æ—Ç—á–µ—Ç–æ–≤?"
```

### –ö–æ–≥–¥–∞ –û–ë–Ø–ó–ê–¢–ï–õ–¨–ù–û –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É–±–∞–≥–µ–Ω—Ç–æ–≤:
- ‚ùó –ü—Ä–∏ –≤–æ–ø—Ä–æ—Å–∞—Ö –æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –ø—Ä–æ–µ–∫—Ç–∞
- ‚ùó –ü—Ä–∏ –ø–æ–∏—Å–∫–µ —Å–ø–µ—Ü–∏—Ñ–∏—á–Ω–æ–≥–æ –∫–æ–¥–∞
- ‚ùó –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –∞–Ω–∞–ª–∏–∑–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–∞ —Ñ–∞–π–ª–æ–≤
- ‚ùó –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–ª–Ω–æ–π –∫–∞—Ä—Ç–∏–Ω—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞
- ‚ùó –ü–µ—Ä–µ–¥ –≤–Ω–µ—Å–µ–Ω–∏–µ–º –∏–∑–º–µ–Ω–µ–Ω–∏–π - –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- ‚ùó –ü—Ä–∏ –æ—Ç–ª–∞–¥–∫–µ –æ—à–∏–±–æ–∫ - –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å–≤—è–∑–∞–Ω–Ω–æ–≥–æ –∫–æ–¥–∞

### –°—Ç—Ä–∞—Ç–µ–≥–∏—è —Ä–∞–±–æ—Ç—ã:
1. **–°–Ω–∞—á–∞–ª–∞ –∏—Å—Å–ª–µ–¥—É–π** - –∏—Å–ø–æ–ª—å–∑—É–π —Å—É–±–∞–≥–µ–Ω—Ç–∞ –¥–ª—è –ø–æ–Ω–∏–º–∞–Ω–∏—è –∫–æ–¥–∞
2. **–ó–∞—Ç–µ–º –ø–ª–∞–Ω–∏—Ä—É–π** - –Ω–∞ –æ—Å–Ω–æ–≤–µ –ø–æ–ª—É—á–µ–Ω–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏
3. **–ü–æ—Ç–æ–º —Ä–µ–∞–ª–∏–∑—É–π** - –≤–Ω–æ—Å–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å –ø–æ–ª–Ω—ã–º –ø–æ–Ω–∏–º–∞–Ω–∏–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞

### –ß–∞—Å—Ç—ã–µ –∑–∞–¥–∞—á–∏ –∏ –Ω—É–∂–Ω—ã–µ —Å—É–±–∞–≥–µ–Ω—Ç—ã:
- **"–î–æ–±–∞–≤—å –Ω–æ–≤—É—é —Ñ—É–Ω–∫—Ü–∏—é"** ‚Üí –°–Ω–∞—á–∞–ª–∞ Task: "–ù–∞–π–¥–∏ –ø–æ—Ö–æ–∂–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –∫–∞–∫ –æ–Ω–∏ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã"
- **"–ò—Å–ø—Ä–∞–≤—å –æ—à–∏–±–∫—É"** ‚Üí –°–Ω–∞—á–∞–ª–∞ Task: "–ù–∞–π–¥–∏ –≥–¥–µ –≤–æ–∑–Ω–∏–∫–∞–µ—Ç —ç—Ç–∞ –æ—à–∏–±–∫–∞ –∏ —Å–≤—è–∑–∞–Ω–Ω—ã–π –∫–æ–¥"
- **"–ò–∑–º–µ–Ω–∏ –ø–æ–≤–µ–¥–µ–Ω–∏–µ"** ‚Üí –°–Ω–∞—á–∞–ª–∞ Task: "–ö–∞–∫ —Å–µ–π—á–∞—Å —Ä–∞–±–æ—Ç–∞–µ—Ç —ç—Ç–∞ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å?"

## –†–∞–±–æ—Ç–∞ —Å —Å–µ—Ä–≤–µ—Ä–æ–º
**–í–ê–ñ–ù–û:** –Ø –ù–ï –º–æ–≥—É –Ω–∞–ø—Ä—è–º—É—é –ø–æ–¥–∫–ª—é—á–∞—Ç—å—Å—è –∫ —Å–µ—Ä–≤–µ—Ä—É —á–µ—Ä–µ–∑ SSH –∏–ª–∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å –∫–æ–º–∞–Ω–¥—ã –Ω–∞ —É–¥–∞–ª–µ–Ω–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ.

–ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ª–æ–≥–æ–≤ –∏–ª–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:
1. –Ø –¥–æ–ª–∂–µ–Ω –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å –∫–æ–º–∞–Ω–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–ø–æ–ª–Ω–∏—Ç –∫–æ–º–∞–Ω–¥—É –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
3. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—Å—Ç–∞–≤–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç –æ–±—Ä–∞—Ç–Ω–æ

## Server Configuration
- Server IP: 80.66.87.178
- Domain: expensebot.duckdns.org
- Server path: /home/batman/expense_bot
- Server OS: Ubuntu 22.04.5 LTS
- SSL: Let's Encrypt certificate (expires 2025-11-07)
- Web server: Nginx 1.18.0 with reverse proxy to Django on port 8000

## Docker Containers
- expense_bot_web - Django admin panel (port 8000)
- expense_bot_app - Telegram bot
- expense_bot_celery - Background tasks
- expense_bot_celery_beat - Scheduled tasks
- expense_bot_db - PostgreSQL 15
- expense_bot_redis - Redis cache

## Database
- Type: PostgreSQL 15 (Alpine)
- Database name: expense_bot
- User: batman
- Container: expense_bot_db

## Static Files
- Container path: /app/staticfiles/
- Host path: /home/batman/expense_bot/staticfiles/
- Nginx alias: /var/www/expense_bot_static/ (symlink)
- Served directly by Nginx at /static/

## Admin Panel
- URL: https://expensebot.duckdns.org/admin/
- Superuser: admin or batman
- CSRF configured for HTTPS
- Static files served by Nginx

## Update Process
Standard update commands:
```bash
cd /home/batman/expense_bot && \
docker-compose down && \
git fetch --all && \
git reset --hard origin/master && \
git pull origin master && \
docker-compose build --no-cache && \
docker-compose up -d --force-recreate && \
docker image prune -f
```

## Important Files on Server
- /etc/nginx/sites-available/expensebot - Nginx config
- /etc/letsencrypt/live/expensebot.duckdns.org/ - SSL certificates
- ~/expense_bot/.env - Environment variables (not in git)
- ~/expense_bot/nginx/expensebot-ssl.conf - SSL config backup

## Automated Services
- Certbot auto-renewal for SSL
- Cron job for nginx restoration after reboot
- Docker containers auto-restart policy: unless-stopped

## Recent Changes
- Added grocery store keywords (–ö–ë, –ö—Ä–∞—Å–Ω–æ–µ –±–µ–ª–æ–µ, –í–í) to product category
- Made description optional for recurring payments (uses category name if empty)
- Fixed trial subscription reset issue (now only granted once)
- Fixed case preservation in expense descriptions
- Added HTTPS support with Let's Encrypt
- Configured Django admin panel with proper CSRF settings

## Security Notes
- DEBUG=False in production
- SECURE_SSL_REDIRECT=False (handled by nginx)
- CSRF_TRUSTED_ORIGINS includes https://expensebot.duckdns.org
- SESSION_COOKIE_SECURE=True
- CSRF_COOKIE_SECURE=True

## Legacy Server Information (Old)
- IP: 194.87.98.75
- –ü—É—Ç—å –∫ –ø—Ä–æ–µ–∫—Ç—É: /root/expense_bot
- –õ–æ–≥–∏ Django: /root/expense_bot/logs/django.log

## –ö–æ–º–∞–Ω–¥—ã –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ PDF –æ—Ç—á–µ—Ç–æ–≤
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö –æ—à–∏–±–æ–∫ –≤ –ª–æ–≥–∞—Ö Django
tail -n 100 /root/expense_bot/logs/django.log | grep -E "(PDF|pdf|report|–æ—Ç—á–µ—Ç|error|ERROR|Exception)"

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ª–æ–≥–æ–≤
journalctl -u expense_bot -n 100 --no-pager

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Playwright
cd /root/expense_bot && source venv/bin/activate && playwright --version

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –±—Ä–∞—É–∑–µ—Ä–æ–≤ Playwright
cd /root/expense_bot && source venv/bin/activate && playwright show-browsers
```