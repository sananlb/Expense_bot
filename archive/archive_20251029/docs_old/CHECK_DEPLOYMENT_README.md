# –°–∫—Ä–∏–ø—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

## üìã –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ

`check_deployment.sh` - –∫–æ–º–ø–ª–µ–∫—Å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤ ExpenseBot –ø–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ.

## üéØ –ö–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

**–í–°–ï–ì–î–ê –∑–∞–ø—É—Å–∫–∞–π—Ç–µ —ç—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç –ø–æ—Å–ª–µ:**
- –û–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–¥–∞ –∏–∑ Git
- –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞ Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
- –ò–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
- –ü—Ä–∏ –ø–æ–¥–æ–∑—Ä–µ–Ω–∏–∏ –Ω–∞ –ø—Ä–æ–±–ª–µ–º—ã —Å –±–æ—Ç–æ–º

## üöÄ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –ù–∞ —Å–µ—Ä–≤–µ—Ä–µ
```bash
ssh batman@80.66.87.178
cd /home/batman/expense_bot
bash check_deployment.sh
```

### –û–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π —Å –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∫–æ–º–ø—å—é—Ç–µ—Ä–∞
```bash
ssh batman@80.66.87.178 'cd /home/batman/expense_bot && bash check_deployment.sh'
```

## ‚úÖ –ß—Ç–æ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å–∫—Ä–∏–ø—Ç

### 1. Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
- –í—Å–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã –∑–∞–ø—É—â–µ–Ω—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç
- –°—Ç–∞—Ç—É—Å –∫–∞–∂–¥–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞
- –û—Ç–∫—Ä—ã—Ç—ã–µ –ø–æ—Ä—Ç—ã

### 2. –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö PostgreSQL
- –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ë–î
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Å–∏—Å—Ç–µ–º–µ

### 3. Redis
- –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å Redis
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏

### 4. Telegram Bot API
- –í–∞–ª–∏–¥–Ω–æ—Å—Ç—å —Ç–æ–∫–µ–Ω–∞
- –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API Telegram
- Username –±–æ—Ç–∞

### 5. Webhook (–ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û!)
- **Webhook URL —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω** (–µ—Å–ª–∏ –ø—É—Å—Ç–æ–π - –±–æ—Ç –ù–ï —Ä–∞–±–æ—Ç–∞–µ—Ç!)
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ pending updates (–µ—Å–ª–∏ >10 - –ø—Ä–æ–±–ª–µ–º–∞)
- Last error message –æ—Ç Telegram

### 6. Celery Workers
- –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å Celery workers
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≤–æ—Ä–∫–µ—Ä–∞–º

### 7. Webhook endpoint
- –î–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å webhook URL —Å–Ω–∞—Ä—É–∂–∏
- HTTP —Å—Ç–∞—Ç—É—Å (405 –∏–ª–∏ 200 = OK)

### 8. –õ–æ–≥–∏
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –æ—à–∏–±–æ–∫ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —á–∞—Å
- –ü–æ—Å–ª–µ–¥–Ω–∏–µ 5 –æ—à–∏–±–æ–∫ (–µ—Å–ª–∏ –µ—Å—Ç—å)

### 9. –î–∏—Å–∫–æ–≤–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞
- –î–æ—Å—Ç—É–ø–Ω–æ–µ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ
- –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ø—Ä–∏ >80%, –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞ –ø—Ä–∏ >90%

## üìä –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

### ‚úÖ –£—Å–ø–µ—à–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞
```
==================================
–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã
==================================

=== 1. Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã ===
NAMES                        STATUS              PORTS
expense_bot_app             Up 2 hours          0.0.0.0:8001->8000/tcp
expense_bot_web             Up 2 hours          0.0.0.0:8000->8000/tcp
...

=== 5. Telegram Webhook ===
Webhook URL: https://expensebot.duckdns.org/webhook/
Pending updates: 0

==================================
‚úÖ –í—Å–µ –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ!
==================================
```

### ‚ùå –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞
```
=== 5. Telegram Webhook ===
‚ö†Ô∏è  –ö–†–ò–¢–ò–ß–ï–°–ö–ê–Ø –ü–†–û–ë–õ–ï–ú–ê: Webhook URL –ø—É—Å—Ç–æ–π!
–ë–æ—Ç –ù–ï –ø–æ–ª—É—á–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –æ—Ç Telegram!

–ó–∞–ø—É—Å—Ç–∏—Ç–µ: bash ~/fix_webhook_force.sh

==================================
‚ùå –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ –ø—Ä–æ–±–ª–µ–º: 1
==================================

–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏: docker logs expense_bot_app --tail 100
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤: docker ps -a
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–æ–±–ª–µ–º–Ω—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã: docker restart <container_name>
```

## üî¥ –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–ï—Å–ª–∏ —Å–∫—Ä–∏–ø—Ç –æ–±–Ω–∞—Ä—É–∂–∏—Ç –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã, –æ–Ω –≤—ã–≤–µ–¥–µ—Ç –∏—Ö —Å emoji ‚ö†Ô∏è –∏ –¥–∞—Å—Ç —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏.

### –ü—É—Å—Ç–æ–π Webhook URL
**–°–∏–º–ø—Ç–æ–º:** `Webhook URL –ø—É—Å—Ç–æ–π!`

**–†–µ—à–µ–Ω–∏–µ:**
```bash
bash ~/fix_webhook_force.sh
```

### –ú–Ω–æ–≥–æ pending updates
**–°–∏–º–ø—Ç–æ–º:** `WARNING: 15 pending updates in webhook queue`

**–ü—Ä–∏—á–∏–Ω–∞:** –ë–æ—Ç –Ω–µ —É—Å–ø–µ–≤–∞–µ—Ç –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∏–ª–∏ –±—ã–ª –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏ –±–æ—Ç–∞
2. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å –±–æ—Ç: `docker restart expense_bot_app`
3. –ï—Å–ª–∏ –Ω–µ –ø–æ–º–æ–≥–ª–æ - `bash ~/fix_webhook_force.sh`

### Celery workers –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç
**–°–∏–º–ø—Ç–æ–º:** `Celery workers: FAILED`

**–†–µ—à–µ–Ω–∏–µ:**
```bash
docker restart expense_bot_celery expense_bot_celery_beat
docker logs expense_bot_celery --tail 50
```

### –ú–∞–ª–æ –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞
**–°–∏–º–ø—Ç–æ–º:** `–ö–†–ò–¢–ò–ß–ï–°–ö–û–ï: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–∏—Å–∫–∞ 95%`

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –û—á–∏—Å—Ç–∏—Ç—å Docker
docker system prune -a -f

# –û—á–∏—Å—Ç–∏—Ç—å —Å—Ç–∞—Ä—ã–µ –ª–æ–≥–∏
find /home/batman/expense_bot/logs -name "*.log.*" -mtime +30 -delete

# –£–¥–∞–ª–∏—Ç—å —Å—Ç–∞—Ä—ã–µ —Ä–µ–∑–µ—Ä–≤–Ω—ã–µ –∫–æ–ø–∏–∏
find /home/batman/backups -name "*.sql" -mtime +30 -delete
```

## üîß –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ –ø—Ä–æ—Ü–µ—Å—Å –¥–µ–ø–ª–æ—è

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–π –ø—Ä–æ—Ü–µ—Å—Å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞

1. **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞:**
   ```bash
   cd /home/batman/expense_bot && bash update.sh
   ```

2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è:**
   ```bash
   bash check_deployment.sh
   ```

3. **–ï—Å–ª–∏ –µ—Å—Ç—å –ø—Ä–æ–±–ª–µ–º—ã:**
   - –°–ª–µ–¥—É–π—Ç–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è–º —Å–∫—Ä–∏–ø—Ç–∞
   - –ó–∞–ø—É—Å—Ç–∏—Ç–µ check_deployment.sh —Å–Ω–æ–≤–∞ –ø–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

## üìù –¶–≤–µ—Ç–Ω–æ–π –≤—ã–≤–æ–¥

- üü¢ **–ó–µ–ª–µ–Ω—ã–π** - –≤—Å—ë OK
- üü° **–ñ–µ–ª—Ç—ã–π** - –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ)
- üî¥ **–ö—Ä–∞—Å–Ω—ã–π** - –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–±–ª–µ–º–∞ (—Ç—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è)

## ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
```bash
# –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è line endings (–µ—Å–ª–∏ –Ω—É–∂–Ω–æ)
dos2unix check_deployment.sh

# –ü—Ä–∞–≤–∞ –Ω–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ
chmod +x check_deployment.sh

# –ó–∞–ø—É—Å–∫
bash check_deployment.sh
```

## üêõ Troubleshooting

### –°–∫—Ä–∏–ø—Ç –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
```bash
# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞
ls -la check_deployment.sh

# –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–∞–≤–∞
chmod +x check_deployment.sh

# –ó–∞–ø—É—Å—Ç–∏—Ç—å —è–≤–Ω–æ —á–µ—Ä–µ–∑ bash
bash check_deployment.sh
```

### –û—à–∏–±–∫–∞ "command not found"
–°–∫—Ä–∏–ø—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã Linux. –ï—Å–ª–∏ –∫–∞–∫–∞—è-—Ç–æ –∫–æ–º–∞–Ω–¥–∞ –Ω–µ –Ω–∞–π–¥–µ–Ω–∞:
```bash
# –î–ª—è dos2unix
sudo apt-get install dos2unix

# –î–ª—è curl (–æ–±—ã—á–Ω–æ —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
sudo apt-get install curl
```

## üìö –°–º. —Ç–∞–∫–∂–µ

- `docs/SERVER_COMMANDS.md` - –ø–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥ –¥–ª—è —Å–µ—Ä–≤–µ—Ä–∞
- `docs/WEBHOOK_DEPLOYMENT.md` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ webhook
- `fix_webhook_force.sh` - —Å–∫—Ä–∏–ø—Ç –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è webhook
- `update.sh` - —Å–∫—Ä–∏–ø—Ç –ø–æ–ª–Ω–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞
