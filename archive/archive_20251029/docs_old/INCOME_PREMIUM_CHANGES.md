# Изменения: Учет доходов как премиум-функция

## Дата внесения изменений: 23.09.2025

## Внесенные изменения:

### 1. Ограничение функции учета доходов
**Файл:** `bot/routers/expense.py` (строки 1000-1031)

- Добавлена проверка подписки при попытке ввода дохода
- При отсутствии подписки выводится информативное сообщение о премиум-функции
- Доходы можно вводить только с активной подпиской

### 2. Обновление лендинга
**Файл:** `landing/index.html`

#### Изменения в тарифах:
**Бесплатный тариф:**
- Было: "Учет расходов и доходов"
- Стало: "Только учет расходов" + "Учет доходов" (отключено)

**Premium тариф:**
- "Только учет расходов" (включено)
- "Учет доходов" (включено)

#### Добавлены новые ключи локализации:
- `feat_expense_only` - "Только учет расходов" / "Expense tracking only"
- `feat_income_tracking` - "Учет доходов" / "Income tracking"

## Как это работает:

1. При вводе сообщения с доходом (начинается с `+` или содержит слово "плюс"):
   - Система определяет намерение ввода дохода через `detect_income_intent()`
   - Проверяется наличие подписки через `check_subscription()`
   - Если подписки нет - показывается сообщение о необходимости оформить подписку
   - Если подписка есть - доход обрабатывается как обычно

2. Бета-тестеры имеют полный доступ ко всем функциям без подписки

## Тестирование:
Создан тестовый файл `test_income_premium.py` для проверки:
- Корректного определения доходов
- Проверки подписки
- Отображения правильного сообщения

## Команды для деплоя на сервер:
```bash
# Подключение к серверу
ssh batman@80.66.87.178

# Обновление кода
cd /home/batman/expense_bot
git pull

# Перезапуск контейнеров
docker-compose restart expense_bot_app

# Обновление лендинга
sudo cp -rf landing/* /var/www/coins-bot/
sudo chown -R www-data:www-data /var/www/coins-bot/
sudo nginx -s reload
```

## Примечания:
- Английская версия лендинга (index_en.html) упрощенная и не содержит информации о тарифах
- Все существующие доходы пользователей сохранены и доступны для просмотра
- Изменение затрагивает только новые попытки ввода доходов