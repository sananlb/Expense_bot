# –û—Ç—á—ë—Ç: –ü–æ–ª–µ `income_type` –≤ –º–æ–¥–µ–ª–∏ Income

**–î–∞—Ç–∞:** 2025-12-02
**–û–±–Ω–æ–≤–ª–µ–Ω–æ:** 2025-12-02 (–ø–æ—Å–ª–µ —Ä–µ–≤—å—é)
**–°—Ç–∞—Ç—É—Å:** –ö–∞–Ω–¥–∏–¥–∞—Ç –Ω–∞ —É–¥–∞–ª–µ–Ω–∏–µ
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –ù–∏–∑–∫–∏–π (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ, –Ω–æ —Å–æ–∑–¥–∞—ë—Ç —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥)

---

## 1. –û–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–±–ª–µ–º—ã

–ü–æ–ª–µ `income_type` –≤ –º–æ–¥–µ–ª–∏ `Income` **–¥—É–±–ª–∏—Ä—É–µ—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∫–∞—Ç–µ–≥–æ—Ä–∏–π –¥–æ—Ö–æ–¥–æ–≤** (`IncomeCategory`). –≠—Ç–æ —Å–æ–∑–¥–∞—ë—Ç:
- –ò–∑–±—ã—Ç–æ—á–Ω–æ—Å—Ç—å –¥–∞–Ω–Ω—ã—Ö
- –£—Å–ª–æ–∂–Ω–µ–Ω–∏–µ –∫–æ–¥–∞
- –ü—É—Ç–∞–Ω–∏—Ü—É –≤ –ª–æ–≥–∏–∫–µ
- –†–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ (–ø–æ–ª–µ –ù–ï –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ —Å–º–µ–Ω–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏)

---

## 2. –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ–ª—è

**–§–∞–π–ª:** `expenses/models.py` (—Å—Ç—Ä–æ–∫–∏ 1025-1038)

```python
income_type = models.CharField(
    max_length=20,
    default='other',
    choices=[
        ('salary', '–ó–∞—Ä–ø–ª–∞—Ç–∞'),
        ('bonus', '–ü—Ä–µ–º–∏—è'),
        ('freelance', '–§—Ä–∏–ª–∞–Ω—Å'),
        ('investment', '–ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏'),
        ('gift', '–ü–æ–¥–∞—Ä–æ–∫'),
        ('refund', '–í–æ–∑–≤—Ä–∞—Ç'),
        ('cashback', '–ö–µ—à–±—ç–∫'),
        ('other', '–ü—Ä–æ—á–µ–µ')
    ]
)
```

**–•–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏:**
- –¢–∏–ø: `CharField(max_length=20)`
- –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é: `'other'`
- 8 —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
- NOT NULL –≤ –ë–î

---

## 3. –ü—Ä–æ–±–ª–µ–º–∞ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è

### –ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–æ—Ö–æ–¥–æ–≤ (IncomeCategory)

–£ –Ω–∞—Å –µ—Å—Ç—å –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–π –¥–æ—Ö–æ–¥–æ–≤ —Å:
- –ò–∫–æ–Ω–∫–∞–º–∏
- –ú—É–ª—å—Ç–∏—è–∑—ã—á–Ω—ã–º–∏ –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏
- –ö–ª—é—á–µ–≤—ã–º–∏ —Å–ª–æ–≤–∞–º–∏ –¥–ª—è –∞–≤—Ç–æ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —Å–æ–∑–¥–∞–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π

### –ú–∞–ø–ø–∏–Ω–≥ income_type ‚Üî –∫–∞—Ç–µ–≥–æ—Ä–∏—è

–í —Ñ–∞–π–ª–µ `bot/utils/income_category_definitions.py` –∫–∞–∂–¥–∞—è **–≤—Å—Ç—Ä–æ–µ–Ω–Ω–∞—è** –∫–∞—Ç–µ–≥–æ—Ä–∏—è —Å–≤—è–∑–∞–Ω–∞ —Å `income_type`:

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | income_type |
|-----------|-------------|
| üíº –ó–∞—Ä–ø–ª–∞—Ç–∞ | `salary` |
| üéÅ –ü—Ä–µ–º–∏–∏ –∏ –±–æ–Ω—É—Å—ã | `bonus` |
| üíª –§—Ä–∏–ª–∞–Ω—Å | `freelance` |
| üìà –ò–Ω–≤–µ—Å—Ç–∏—Ü–∏–∏ | `investment` |
| üéÄ –ü–æ–¥–∞—Ä–∫–∏ | `gift` |
| ‚Ü©Ô∏è –í–æ–∑–≤—Ä–∞—Ç—ã | `refund` |
| üí≥ –ö–µ—à–±—ç–∫ | `cashback` |
| üí∞ –ü—Ä–æ—á–∏–µ –¥–æ—Ö–æ–¥—ã | `other` |

**–í–∞–∂–Ω–æ:** –ú–∞–ø–ø–∏–Ω–≥ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –¢–û–õ–¨–ö–û –¥–ª—è –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –≤—Å–µ–≥–¥–∞ –ø–æ–ª—É—á–∞—é—Ç `income_type='other'`.

**–í—ã–≤–æ–¥:** `income_type` ‚Äî —ç—Ç–æ –ø—Ä–æ—Å—Ç–æ "–∫–ª—é—á" –∫–∞—Ç–µ–≥–æ—Ä–∏–∏, –Ω–æ —Ö—Ä–∞–Ω–∏—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–º –ø–æ–ª–µ–º.

---

## 4. –ì–¥–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è income_type

### 4.1. –ó–∞–ø–∏—Å—å (—Å–æ–∑–¥–∞–Ω–∏–µ –¥–æ—Ö–æ–¥–æ–≤) ‚Äî "–ø—Ä–æ–∫–∞—Ç—ã–≤–∞–µ—Ç—Å—è" —á–µ—Ä–µ–∑ –∫–æ–¥

| –§–∞–π–ª | –°—Ç—Ä–æ–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|--------|----------|
| `bot/services/income.py` | 38 | –ü–∞—Ä–∞–º–µ—Ç—Ä —Ñ—É–Ω–∫—Ü–∏–∏ `create_income()` |
| `bot/services/income.py` | 161 | –ó–∞–ø–∏—Å—å –≤ `Income.objects.create()` |
| `bot/routers/expense.py` | 1327 | –ü–µ—Ä–µ–¥–∞—á–∞ –≤ `create_income()` –∏–∑ –ø–∞—Ä—Å–µ—Ä–∞ |
| `bot/services/recurring.py` | 194 | –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –¥–æ—Ö–æ–¥—ã (**–≤—Å–µ–≥–¥–∞ `'other'`!**) |

### 4.2. –ß—Ç–µ–Ω–∏–µ (—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞) ‚Äî –†–ï–ê–õ–¨–ù–û–ï –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

| –§–∞–π–ª | –°—Ç—Ä–æ–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|--------|----------|
| `bot/services/income.py` | 306-310 | –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Ç–∏–ø–∞–º –≤ `get_incomes_summary()` |
| `bot/services/income.py` | 907-910 | –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –≤ `get_month_incomes_summary()` |

**‚ö†Ô∏è –≠—Ç–æ –ï–î–ò–ù–°–¢–í–ï–ù–ù–û–ï —Ä–µ–∞–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ** ‚Äî –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –¥–ª—è –æ—Ç—á—ë—Ç–æ–≤. –í—Å—ë –æ—Å—Ç–∞–ª—å–Ω–æ–µ ‚Äî –ø—Ä–æ—Å—Ç–æ "–ø—Ä–æ–∫–∞—Ç–∫–∞" –∑–Ω–∞—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ –º–æ–¥–µ–ª–∏/—Ñ–æ—Ä–º—ã.

### 4.3. –ú–∞–ø–ø–∏–Ω–≥ (–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –ø—Ä–∏ –ø–∞—Ä—Å–∏–Ω–≥–µ)

| –§–∞–π–ª | –°—Ç—Ä–æ–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|--------|----------|
| `bot/utils/expense_parser.py` | 1273 | –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑ –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –¥–æ—Ö–æ–¥–∞ |
| `bot/utils/expense_parser.py` | 1292-1406 | –í—ã–∑–æ–≤—ã `get_income_type(category_key)` |
| `bot/utils/income_category_definitions.py` | 16-73 | –°–ª–æ–≤–∞—Ä—å —Å –º–∞–ø–ø–∏–Ω–≥–æ–º –∫–∞—Ç–µ–≥–æ—Ä–∏—è‚Üí—Ç–∏–ø |
| `bot/utils/income_category_definitions.py` | 88-95 | –§—É–Ω–∫—Ü–∏—è `get_income_type()` |

### 4.4. –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ (Django Admin)

| –§–∞–π–ª | –°—Ç—Ä–æ–∫–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|--------|----------|
| `expenses/admin.py` | ~~list_display~~ | ‚úÖ –£–∂–µ —É–±—Ä–∞–Ω–æ |
| `expenses/admin.py` | ~~list_filter~~ | ‚úÖ –£–∂–µ —É–±—Ä–∞–Ω–æ |
| `expenses/admin.py` | 761-763 | –°–µ–∫—Ü–∏—è "–¢–∏–ø –¥–æ—Ö–æ–¥–∞" –≤ `fieldsets` (–æ—Å—Ç–∞–ª–æ—Å—å) |

### 4.5. –ú–∏–≥—Ä–∞—Ü–∏–∏

| –§–∞–π–ª | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|
| `expenses/migrations/0020_incomecategory_income_and_more.py` | –°–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—è |

---

## 5. –ü–æ—á–µ–º—É —ç—Ç–æ –∏–∑–±—ã—Ç–æ—á–Ω–æ

### –ü—Ä–æ–±–ª–µ–º–∞ 1: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏

```
–î–æ—Ö–æ–¥ ‚Üí category_id ‚Üí IncomeCategory ‚Üí (name, icon, keywords)
–î–æ—Ö–æ–¥ ‚Üí income_type ‚Üí —Å—Ç—Ä–æ–∫–∞ —Ç–∏–ø–∞ 'salary'
```

–û–±–∞ –ø–æ–ª—è –Ω–µ—Å—É—Ç **–æ–¥–Ω—É –∏ —Ç—É –∂–µ —Å–µ–º–∞–Ω—Ç–∏–∫—É** ‚Äî —Ç–∏–ø/–∫–∞—Ç–µ–≥–æ—Ä–∏—é –¥–æ—Ö–æ–¥–∞.

### –ü—Ä–æ–±–ª–µ–º–∞ 2: –†–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç:
1. –°–æ–∑–¥–∞—Ç—å –¥–æ—Ö–æ–¥ —Å –∫–∞—Ç–µ–≥–æ—Ä–∏–µ–π "üíº –ó–∞—Ä–ø–ª–∞—Ç–∞" (`income_type='salary'`)
2. –ü–æ–∑–∂–µ –∏–∑–º–µ–Ω–∏—Ç—å –∫–∞—Ç–µ–≥–æ—Ä–∏—é –Ω–∞ "üéÅ –ü—Ä–µ–º–∏–∏" —á–µ—Ä–µ–∑ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** `income_type` –æ—Å—Ç–∞–Ω–µ—Ç—Å—è `'salary'`, –∞ –∫–∞—Ç–µ–≥–æ—Ä–∏—è –±—É–¥–µ—Ç "–ü—Ä–µ–º–∏–∏" ‚Äî –¥–∞–Ω–Ω—ã–µ —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω—ã.

### –ü—Ä–æ–±–ª–µ–º–∞ 3: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏

–ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞—ë—Ç —Å–≤–æ—é –∫–∞—Ç–µ–≥–æ—Ä–∏—é "üíµ –î–∏–≤–∏–¥–µ–Ω–¥—ã":
- `income_type` –±—É–¥–µ—Ç `'other'` (–Ω–µ—Ç –≤ —Å–ø–∏—Å–∫–µ choices)
- –í—Å—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –ø–æ —Ç–∏–ø–∞–º —Ç–µ—Ä—è–µ—Ç —Å–º—ã—Å–ª

### –ü—Ä–æ–±–ª–µ–º–∞ 4: –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –¥–æ—Ö–æ–¥—ã

–í `recurring.py` —Å—Ç—Ä–æ–∫–∞ 194:
```python
income_type='other'  # –í—Å–µ–≥–¥–∞ 'other'!
```

–†–µ–≥—É–ª—è—Ä–Ω–∞—è –∑–∞—Ä–ø–ª–∞—Ç–∞ –±—É–¥–µ—Ç –∏–º–µ—Ç—å `income_type='other'` –≤–º–µ—Å—Ç–æ `'salary'`.

---

## 6. –†–µ–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

–ù–∞ –æ—Å–Ω–æ–≤–µ —Ñ–∏–∫—Å—Ç—É—Ä (`complete_migration_fixtures_20250916_012234.json`):

| income_type | –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ | –ü—Ä–æ—Ü–µ–Ω—Ç |
|-------------|------------|---------|
| `other` | 16 | 80% |
| `bonus` | 3 | 15% |
| `salary` | 1 | 5% |
| `refund` | 1 | 5% |
| `freelance` | 0 | 0% |
| `investment` | 0 | 0% |
| `gift` | 0 | 0% |
| `cashback` | 0 | 0% |

**–í—ã–≤–æ–¥:** 80% –¥–æ—Ö–æ–¥–æ–≤ –∏–º–µ—é—Ç —Ç–∏–ø `'other'`, —á—Ç–æ –¥–µ–ª–∞–µ—Ç –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É –ø–æ —Ç–∏–ø–∞–º –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω–æ–π.

---

## 7. –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è

### –í–∞—Ä–∏–∞–Ω—Ç A: –ü–æ–ª–Ω–æ–µ —É–¥–∞–ª–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–ü–ª—é—Å—ã:**
- –£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è
- –£–ø—Ä–æ—â–µ–Ω–∏–µ –∫–æ–¥–∞
- –û–¥–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ –∫–∞—Ç–µ–≥–æ—Ä–∏–∑–∞—Ü–∏–∏
- –ù–µ—Ç —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏

**–ú–∏–Ω—É—Å—ã:**
- –¢—Ä–µ–±—É–µ—Ç –º–∏–≥—Ä–∞—Ü–∏–∏ Django
- –ù—É–∂–Ω–æ –ø–µ—Ä–µ–¥–µ–ª–∞—Ç—å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É –≤ –æ—Ç—á—ë—Ç–∞—Ö (–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `category.name`)

---

## 8. –ü–ª–∞–Ω —É–¥–∞–ª–µ–Ω–∏—è (–ø–æ—à–∞–≥–æ–≤—ã–π) ‚Äî ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û 2025-12-02

### –®–∞–≥ 1: –ú–æ–¥–µ–ª—å (`expenses/models.py`)
- [x] ‚úÖ –£–¥–∞–ª–∏—Ç—å –ø–æ–ª–µ `income_type` (—Å—Ç—Ä–æ–∫–∏ 1025-1038)

### –®–∞–≥ 2: –ú–∏–≥—Ä–∞—Ü–∏—è Django
- [x] ‚úÖ –í—ã–ø–æ–ª–Ω–∏—Ç—å `python manage.py makemigrations` ‚Äî —Å–æ–∑–¥–∞–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è `0056_remove_income_type_field.py`
- [x] ‚úÖ –í—ã–ø–æ–ª–Ω–∏—Ç—å `python manage.py migrate` ‚Äî –ø—Ä–∏–º–µ–Ω–µ–Ω–æ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î
- [ ] **–ù–ê –°–ï–†–í–ï–†–ï:** –ø—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –≤ Docker

### –®–∞–≥ 3: –°–µ—Ä–≤–∏—Å –¥–æ—Ö–æ–¥–æ–≤ (`bot/services/income.py`)
- [x] ‚úÖ –°—Ç—Ä–æ–∫–∞ 38: —É–±—Ä–∞—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä `income_type: str = 'other'` –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏ `create_income()`
- [x] ‚úÖ –°—Ç—Ä–æ–∫–∞ 52: —É–±—Ä–∞—Ç—å –∏–∑ docstring
- [x] ‚úÖ –°—Ç—Ä–æ–∫–∞ 161: —É–±—Ä–∞—Ç—å `income_type=income_type` –∏–∑ `Income.objects.create()`
- [x] ‚úÖ –°—Ç—Ä–æ–∫–∏ 306-310: —É–¥–∞–ª–µ–Ω–∞ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Ç–∏–ø–∞–º (by_type) ‚Äî —Ç–µ–ø–µ—Ä—å —Ç–æ–ª—å–∫–æ –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
- [x] ‚úÖ –°—Ç—Ä–æ–∫–∏ 907-910: –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ —É–¥–∞–ª–µ–Ω–æ

### –®–∞–≥ 4: –†–æ—É—Ç–µ—Ä—ã (`bot/routers/expense.py`)
- [x] ‚úÖ –°—Ç—Ä–æ–∫–∞ 1327: —É–±—Ä–∞—Ç—å `income_type=parsed_income.get('income_type', 'other')` –∏–∑ –≤—ã–∑–æ–≤–∞ `create_income()`

### –®–∞–≥ 5: –†–µ–≥—É–ª—è—Ä–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏ (`bot/services/recurring.py`)
- [x] ‚úÖ –°—Ç—Ä–æ–∫–∞ 194: —É–±—Ä–∞—Ç—å `income_type='other'` –∏–∑ `Income.objects.create()`

### –®–∞–≥ 6: –ü–∞—Ä—Å–µ—Ä (`bot/utils/expense_parser.py`)
- [x] ‚úÖ –°—Ç—Ä–æ–∫–∞ 1273: —É–±—Ä–∞—Ç—å `'income_type': last_income.income_type...`
- [x] ‚úÖ –°—Ç—Ä–æ–∫–∏ 1292, 1308, 1316, 1330, 1371, 1392, 1401, 1406: —É–±—Ä–∞—Ç—å –ø—Ä–∏—Å–≤–æ–µ–Ω–∏—è `income_type = ...`
- [x] ‚úÖ –£–±—Ä–∞—Ç—å –≤—Å–µ –≤—ã–∑–æ–≤—ã `get_income_type()` –∏ –∏–º–ø–æ—Ä—Ç
- [x] ‚úÖ –°—Ç—Ä–æ–∫–∞ 1468: —É–±—Ä–∞—Ç—å `'income_type': income_type` –∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
- [x] ‚úÖ –£–ø—Ä–æ—â—ë–Ω fallback –¥–ª—è –æ–ø–∏—Å–∞–Ω–∏—è (—Å—Ç—Ä–æ–∫–∏ 1427-1453)

### –®–∞–≥ 7: Definitions (`bot/utils/income_category_definitions.py`)
- [x] ‚úÖ –°—Ç—Ä–æ–∫–∏ 16, 23, 30, 37, 44, 51, 58, 65, 73: —É–¥–∞–ª—ë–Ω –∫–ª—é—á `'income_type'` –∏–∑ –≤—Å–µ—Ö —Å–ª–æ–≤–∞—Ä–µ–π
- [x] ‚úÖ –°—Ç—Ä–æ–∫–∏ 88-95: —É–¥–∞–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `get_income_type()`

### –®–∞–≥ 8: –ê–¥–º–∏–Ω–∫–∞ (`expenses/admin.py`)
- [x] ‚úÖ ~~–£–±—Ä–∞—Ç—å –∏–∑ `list_display`~~ ‚Äî —É–∂–µ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ —Ä–∞–Ω–µ–µ
- [x] ‚úÖ ~~–£–±—Ä–∞—Ç—å –∏–∑ `list_filter`~~ ‚Äî —É–∂–µ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ —Ä–∞–Ω–µ–µ
- [x] ‚úÖ –°—Ç—Ä–æ–∫–∏ 761-763: —É–±—Ä–∞—Ç—å —Å–µ–∫—Ü–∏—é "–¢–∏–ø –¥–æ—Ö–æ–¥–∞" –∏–∑ `fieldsets`

### –®–∞–≥ 9: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Äî ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û
- [x] ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω—ã –∏–º–ø–æ—Ä—Ç—ã –≤—Å–µ—Ö –º–æ–¥—É–ª–µ–π
- [x] ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ —Å–∏–≥–Ω–∞—Ç—É—Ä–∞ `create_income()` ‚Äî `income_type` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
- [x] ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–∞ –º–æ–¥–µ–ª—å `Income` ‚Äî –ø–æ–ª–µ `income_type` –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
- [x] ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω `INCOME_CATEGORY_DEFINITIONS` ‚Äî –∫–ª—é—á `income_type` —É–¥–∞–ª—ë–Ω
- [x] ‚úÖ –ü—Ä–æ–≤–µ—Ä–µ–Ω–æ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ `get_income_type()`

---

## 9. –û—Ü–µ–Ω–∫–∞ —Ç—Ä—É–¥–æ–∑–∞—Ç—Ä–∞—Ç

| –ó–∞–¥–∞—á–∞ | –§–∞–π–ª—ã | –í—Ä–µ–º—è |
|--------|-------|-------|
| –£–¥–∞–ª–µ–Ω–∏–µ –∏–∑ –º–æ–¥–µ–ª–∏ | `models.py` | 5 –º–∏–Ω |
| –°–æ–∑–¥–∞–Ω–∏–µ + –ø—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–∏ | ‚Äî | 10 –º–∏–Ω |
| –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ `income.py` (–≤–∫–ª—é—á–∞—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É) | `income.py` | 30 –º–∏–Ω |
| –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ `expense_parser.py` | `expense_parser.py` | 30 –º–∏–Ω |
| –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ `expense.py` —Ä–æ—É—Ç–µ—Ä | `expense.py` | 5 –º–∏–Ω |
| –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ `recurring.py` | `recurring.py` | 5 –º–∏–Ω |
| –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ `income_category_definitions.py` | `income_category_definitions.py` | 15 –º–∏–Ω |
| –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ `admin.py` | `admin.py` | 5 –º–∏–Ω |
| –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ | ‚Äî | 30 –º–∏–Ω |
| **–ò—Ç–æ–≥–æ** | **7 —Ñ–∞–π–ª–æ–≤** | **~2-2.5 —á–∞—Å–∞** |

---

## 10. –ß–µ–∫–ª–∏—Å—Ç —Ñ–∞–π–ª–æ–≤ –¥–ª—è –∏–∑–º–µ–Ω–µ–Ω–∏—è ‚Äî ‚úÖ –í–´–ü–û–õ–ù–ï–ù–û

### –û—Å–Ω–æ–≤–Ω–æ–π –∫–æ–¥ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):
- [x] ‚úÖ `expenses/models.py` ‚Äî —É–¥–∞–ª–µ–Ω–æ –ø–æ–ª–µ `income_type`
- [x] ‚úÖ `bot/services/income.py` ‚Äî —É–±—Ä–∞–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä, –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ, —É–¥–∞–ª–µ–Ω–∞ –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ by_type
- [x] ‚úÖ `bot/services/recurring.py` ‚Äî —É–±—Ä–∞–Ω–æ –∏–∑ `Income.objects.create()`
- [x] ‚úÖ `bot/routers/expense.py` ‚Äî —É–±—Ä–∞–Ω–æ –∏–∑ –≤—ã–∑–æ–≤–∞ `create_income()`
- [x] ‚úÖ `bot/utils/expense_parser.py` ‚Äî —É–±—Ä–∞–Ω–æ –∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –ø–∞—Ä—Å–∏–Ω–≥–∞, —É–±—Ä–∞–Ω—ã –≤—ã–∑–æ–≤—ã –º–∞–ø–ø–∏–Ω–≥–∞
- [x] ‚úÖ `bot/utils/income_category_definitions.py` ‚Äî —É–¥–∞–ª—ë–Ω `'income_type'` –∏–∑ —Å–ª–æ–≤–∞—Ä–µ–π, —É–¥–∞–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è
- [x] ‚úÖ `expenses/admin.py` ‚Äî —É–±—Ä–∞–Ω–æ –∏–∑ `fieldsets`

### –ú–∏–≥—Ä–∞—Ü–∏–∏ (–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):
- [x] ‚úÖ –°–æ–∑–¥–∞–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è `0056_remove_income_type_field.py`
- [x] ‚úÖ –ü—Ä–∏–º–µ–Ω–µ–Ω–∞ –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π –ë–î
- [ ] **–û–°–¢–ê–õ–û–°–¨:** –ü—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

### –ê—Ä—Ö–∏–≤–Ω—ã–µ —Ç–µ—Å—Ç—ã (–∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç—Å—è):
- `archive_20251124/test_celery_quick.py` ‚Äî –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `income_type='regular'` (–Ω–µ–≤–∞–ª–∏–¥–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ!)
- `archive_20251124/test_celery_helper_direct.py` ‚Äî —Ç–æ –∂–µ —Å–∞–º–æ–µ
- `archive_20251124/test_income_keywords_celery.py` ‚Äî —Ç–æ –∂–µ —Å–∞–º–æ–µ

---

## 11. –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –û—Å—Ç–∞–≤–∏—Ç—å –∫–∞–∫ –µ—Å—Ç—å

–ï—Å–ª–∏ –Ω–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ –Ω–∞ —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥:
- –ü–æ–ª–µ –æ—Å—Ç–∞—ë—Ç—Å—è –≤ –ë–î (—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥)
- –£–±—Ä–∞–Ω–æ –∏–∑ –∞–¥–º–∏–Ω–∫–∏ (—á–∞—Å—Ç–∏—á–Ω–æ —Å–¥–µ–ª–∞–Ω–æ)
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Ç–∏–ø–∞–º –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å (–Ω–æ –±–µ—Å—Å–º—ã—Å–ª–µ–Ω–Ω–∞ –ø—Ä–∏ 80% `other`)

---

## 12. –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–ü–æ–ª–µ `income_type` ‚Äî —ç—Ç–æ **—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –¥–æ–ª–≥**, –≤–æ–∑–Ω–∏–∫—à–∏–π –∏–∑-–∑–∞:
1. –ü–µ—Ä–≤–æ–Ω–∞—á–∞–ª—å–Ω–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–æ –ø–æ—è–≤–ª–µ–Ω–∏—è `IncomeCategory`
2. –ñ–µ–ª–∞–Ω–∏—è –∏–º–µ—Ç—å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Ç–∏–ø–æ–≤

**–¢–µ–∫—É—â–µ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**
- **–î—É–±–ª–∏—Ä—É–µ—Ç** –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- **–†–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è** –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ (–Ω–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤ –∫–æ–¥–µ!)
- **–ë–µ—Å–ø–æ–ª–µ–∑–Ω–æ** –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∫–∞—Ç–µ–≥–æ—Ä–∏–π (–≤—Å–µ–≥–¥–∞ `other`)
- **–ë–∞–≥:** —Ä–µ–≥—É–ª—è—Ä–Ω—ã–µ –¥–æ—Ö–æ–¥—ã –≤—Å–µ–≥–¥–∞ `other` –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –∫–∞—Ç–µ–≥–æ—Ä–∏–∏
- **–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è** —Ä–µ–∞–ª—å–Ω–æ —Ç–æ–ª—å–∫–æ –¥–ª—è –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∏ –≤ 2 –º–µ—Å—Ç–∞—Ö (—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞)

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –£–¥–∞–ª–∏—Ç—å –ø—Ä–∏ —Å–ª–µ–¥—É—é—â–µ–º —Ä–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥–µ –æ—Ç—á—ë—Ç–æ–≤. –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫—É –¥–µ–ª–∞—Ç—å –ø–æ `category.name` ‚Äî —ç—Ç–æ –¥–∞—Å—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Ä–∞–±–æ—Ç—É —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º–∏ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º–∏ –∏ —Ä–µ—à–∏—Ç –ø—Ä–æ–±–ª–µ–º—É —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏.
