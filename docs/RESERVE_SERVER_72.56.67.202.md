# –†–µ–∑–µ—Ä–≤–Ω—ã–π —Å–µ—Ä–≤–µ—Ä 72.56.67.202 - –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

**–°–æ–∑–¥–∞–Ω–æ:** 2025-09-29
**–ò—Å—Ç–æ—á–Ω–∏–∫:** –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Nutrition_bot –ø—Ä–æ–µ–∫—Ç–∞
**IP –∞–¥—Ä–µ—Å:** 72.56.67.202
**–ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ:** –†–µ–∑–µ—Ä–≤–Ω—ã–π —Å–µ—Ä–≤–µ—Ä –¥–ª—è –æ–±–æ–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤ (Expense Bot –∏ Nutrition Bot)

## 1. –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ä–µ–∑–µ—Ä–≤–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ

### 1.1 –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ö–∞—Ä–∞–∫—Ç–µ—Ä–∏—Å—Ç–∏–∫–∏
- **IP –∞–¥—Ä–µ—Å:** 72.56.67.202
- **–û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞:** Ubuntu 24.04.1 LTS
- **SSH –¥–æ—Å—Ç—É–ø:** `ssh batman@72.56.67.202`
- **–°—Ç–∞—Ç—É—Å:** –ù–û–í–´–ô —Ä–µ–∑–µ—Ä–≤–Ω—ã–π —Å–µ—Ä–≤–µ—Ä (–∑–∞–º–µ–Ω–∞ 45.95.2.84)
- **–ü—Ä–∏—á–∏–Ω–∞ –∑–∞–º–µ–Ω—ã:** –°–µ—Ç–µ–≤—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –Ω–∞ —Å—Ç–∞—Ä–æ–º —Å–µ—Ä–≤–µ—Ä–µ
- **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å:** batman (—Å sudo –ø—Ä–∞–≤–∞–º–∏)

### 1.2 WireGuard VPN –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- **WireGuard IP:** 100.64.0.3/24
- **Private Key:** `4NQB4c95rbA1KVIwZOdNPdhOeQ9h5VpYtPRjrrZuNHc=`
- **Public Key:** `lt2Ih3Nx0mlHRp85VtJ1mqMeK1HkZk1YZZwYYqJMQGA=`
- **–ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è:** `/etc/wireguard/wg0.conf`
- **Endpoint DB —Å–µ—Ä–≤–µ—Ä–∞:** 193.108.113.78:51820
- **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ DB —Å–µ—Ä–≤–µ—Ä—É:** 100.64.0.1
- **–°—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è:** –í –ø—Ä–æ—Ü–µ—Å—Å–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–ª—è Nutrition Bot

### 1.3 –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω–æ–µ –ü–û
- **Docker CE:** v28.4.0
- **Docker Compose:** v2.39.4
- **WireGuard:** –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- **Git:** –ì–æ—Ç–æ–≤ –∫ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—é —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
- **SSH:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å batman —Å sudo –ø—Ä–∞–≤–∞–º–∏
- **Nginx:** v1.24.0

## 2. –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä–∞

### 2.1 –ú–Ω–æ–≥–æ—Å–µ—Ä–≤–µ—Ä–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
```
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê         ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   MAIN APP –°–ï–†–í–ï–† (–ê–ö–¢–ò–í–ù–´–ô)        ‚îÇ         ‚îÇ   NEW BACKUP APP –°–ï–†–í–ï–†             ‚îÇ
‚îÇ   Expense: 80.66.87.178             ‚îÇ         ‚îÇ   72.56.67.202                      ‚îÇ
‚îÇ   Nutrition: 78.40.216.41           ‚îÇ         ‚îÇ   WireGuard IP: 100.64.0.3          ‚îÇ
‚îÇ   WireGuard IP: 100.64.0.2          ‚îÇ         ‚îÇ   Status: PARTIALLY READY           ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò         ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                  ‚îÇ                                               ‚îÇ
                  ‚îÇ            WireGuard VPN                      ‚îÇ
                  ‚îÇ           100.64.0.0/24                       ‚îÇ
                  ‚îÇ                                               ‚îÇ
                  ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¨‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                                    ‚îÇ
            ‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚ñº‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
            ‚îÇ         DB –°–ï–†–í–ï–† (–ê–ö–¢–ò–í–ù–´–ô)                     ‚îÇ
            ‚îÇ         193.108.113.78                           ‚îÇ
            ‚îÇ         WireGuard IP: 100.64.0.1                 ‚îÇ
            ‚îÇ         PostgreSQL + Redis                       ‚îÇ
            ‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ   OLD BACKUP –°–ï–†–í–ï–† (–î–ï–ê–ö–¢–ò–í–ò–†–û–í–ê–ù) ‚îÇ
‚îÇ   45.95.2.84                        ‚îÇ
‚îÇ   Status: NETWORK ISSUES            ‚îÇ
‚îÇ   Status: DECOMMISSIONED            ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

### 2.2 –†–æ–ª—å –Ω–æ–≤–æ–≥–æ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
- **–û—Å–Ω–æ–≤–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:** Backup –¥–ª—è –æ–±–æ–∏—Ö –ø—Ä–æ–µ–∫—Ç–æ–≤
- **Expense Bot:** ‚úÖ –ü–û–õ–ù–û–°–¢–¨–Æ –ì–û–¢–û–í
- **Nutrition Bot:** ‚è≥ –¢–†–ï–ë–£–ï–¢ –ù–ê–°–¢–†–û–ô–ö–ò

## 3. –†–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–µ –ø—Ä–æ–µ–∫—Ç—ã –Ω–∞ —Ä–µ–∑–µ—Ä–≤–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ

### 3.1 Expense Bot (‚úÖ –ü–û–õ–ù–û–°–¢–¨–Æ –ù–ê–°–¢–†–û–ï–ù)

#### 3.1.1 –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏
- **–°—Ç–∞—Ç—É—Å:** –ü–æ–ª–Ω–æ—Å—Ç—å—é —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω
- **–ü—É—Ç—å:** `/home/batman/expense_bot_deploy/expense_bot/`
- **–î–æ–º–µ–Ω:** https://expensebot.duckdns.org
- **SSL:** Let's Encrypt –¥–æ 27.12.2025
- **–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö:** –õ–æ–∫–∞–ª—å–Ω–∞—è PostgreSQL –≤ Docker
- **Redis:** –õ–æ–∫–∞–ª—å–Ω—ã–π –≤ Docker
- **Webhook URL:** `https://expensebot.duckdns.org/webhook/` (—É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω —Å –æ—Å–Ω–æ–≤–Ω—ã–º —Å–µ—Ä–≤–µ—Ä–æ–º)

#### 3.1.2 Docker –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
- `expense_bot_app` - Telegram –±–æ—Ç (–ø–æ—Ä—Ç 8001)
- `expense_bot_web` - Django –∞–¥–º–∏–Ω–∫–∞ (–ø–æ—Ä—Ç 8000)
- `expense_bot_db` - PostgreSQL
- `expense_bot_redis` - Redis
- `expense_bot_celery` - Celery –≤–æ—Ä–∫–µ—Ä
- `expense_bot_celery_beat` - Celery –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫

#### 3.1.3 Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
```nginx
# /etc/nginx/sites-available/expensebot.conf
server {
    listen 443 ssl;
    server_name expensebot.duckdns.org;

    ssl_certificate /etc/letsencrypt/live/expensebot.duckdns.org/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/expensebot.duckdns.org/privkey.pem;
    include /etc/letsencrypt/options-ssl-nginx.conf;
    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem;

    # Webhook –±–µ–∑ —Ç–æ–∫–µ–Ω–∞ (—Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ)
    location = /webhook/ {
        proxy_pass http://localhost:8001/webhook/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    # Webhook —Å —Ç–æ–∫–µ–Ω–æ–º (–¥–ª—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
    location ~ ^/webhook/(.+)$ {
        proxy_pass http://localhost:8001/webhook/$1;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }

    location /admin/ {
        proxy_pass http://localhost:8000/admin/;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
    }

    location /static/ {
        alias /home/batman/expense_bot_deploy/expense_bot/staticfiles/;
    }

    location / {
        proxy_pass http://localhost:8000/;
    }
}
```

### 3.2 Nutrition Bot (‚è≥ –û–ñ–ò–î–ê–ï–¢ –ù–ê–°–¢–†–û–ô–ö–ò)

#### 3.2.1 –ü–ª–∞–Ω–∏—Ä—É–µ–º–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- **–°—Ç–∞—Ç—É—Å:** –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è –∫ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é
- **–ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–π –ø—É—Ç—å:** `/root/Nutrition_bot_v2/`
- **Git —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:** https://github.com/sananlb/Nutrition_bot
- **–í–µ—Ç–∫–∞:** master
- **Docker Compose:** `/root/Nutrition_bot_v2/deploy/app-server/docker-compose.yml`

#### 3.2.2 –ü–ª–∞–Ω–∏—Ä—É–µ–º—ã–µ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã
| –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä | –û–ø–∏—Å–∞–Ω–∏–µ | –ü–æ—Ä—Ç—ã | Network Mode | –°—Ç–∞—Ç—É—Å |
|-----------|----------|-------|--------------|--------|
| `nutrition_bot` | Telegram –±–æ—Ç | - | bridge | –ù–µ —Å–æ–±—Ä–∞–Ω |
| `nutrition_admin` | Django –∞–¥–º–∏–Ω–∫–∞ | 8001 | host | –ù–µ —Å–æ–±—Ä–∞–Ω |
| `nutrition_custom_admin` | –ö–∞—Å—Ç–æ–º–Ω–∞—è –∞–¥–º–∏–Ω–∫–∞ | 8001:8001 | bridge | –ù–µ —Å–æ–±—Ä–∞–Ω |
| `nutrition_celery_worker` | Celery –≤–æ—Ä–∫–µ—Ä | - | bridge | –ù–µ —Å–æ–±—Ä–∞–Ω |
| `nutrition_celery_beat` | Celery –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ | - | bridge | –ù–µ —Å–æ–±—Ä–∞–Ω |
| `portainer` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Docker | 9443:9443 | bridge | –ù–µ —Å–æ–±—Ä–∞–Ω |

## 4. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –∏–∑ Nutrition Bot

### 4.1 WireGuard –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è Nutrition Bot
```ini
# /etc/wireguard/wg0.conf
[Interface]
PrivateKey = 4NQB4c95rbA1KVIwZOdNPdhOeQ9h5VpYtPRjrrZuNHc=
Address = 100.64.0.3/24
DNS = 8.8.8.8

[Peer]
PublicKey = bTjCKhyAOiuojhg3oYQN8mI3TDxB7QiGGJYpfYWJ4R0=
Endpoint = 193.108.113.78:51820
AllowedIPs = 100.64.0.0/24
PersistentKeepalive = 25
```

### 4.2 –ö–æ–º–∞–Ω–¥—ã —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è WireGuard
```bash
# –ó–∞–ø—É—Å–∫ VPN
sudo systemctl start wg-quick@wg0
sudo systemctl enable wg-quick@wg0

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
sudo wg show
sudo systemctl status wg-quick@wg0

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ DB —Å–µ—Ä–≤–µ—Ä—É
ping -c 3 100.64.0.1
```

### 4.3 –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è Nutrition Bot
```bash
# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ WireGuard VPN
DATABASE_URL=postgresql://batman:Aa07900790@100.64.0.1:5432/nutrition_bot_v2

# Redis –∫–µ—à - –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ WireGuard VPN
REDIS_URL=redis://:l8EyYiHNKp7XcIkwxngBRfq03LsvMCjo@100.64.0.1:6379/1

# Telegram –±–æ—Ç—ã (–∏–¥–µ–Ω—Ç–∏—á–Ω—ã–µ –æ—Å–Ω–æ–≤–Ω–æ–º—É —Å–µ—Ä–≤–µ—Ä—É)
TELEGRAM_BOT_TOKEN=8023416067:AAFf4CK7y4Ir163Ea2RCBWzOyevCCvRLdOw
MONITORING_BOT_TOKEN=1665719947:AAHXIl_IloP0HEUaUczNKKemjqNEy70PAF4

# –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ –¥–ª—è —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
USE_SIMPLE_DOCKER_MONITORING=false
DJANGO_SETTINGS_MODULE=nutrition_bot.settings
```

## 5. –ö–æ–º–∞–Ω–¥—ã –¥–ª—è —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—è –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è

### 5.1 –ö–æ–º–∞–Ω–¥—ã –¥–ª—è Expense Bot (–≥–æ—Ç–æ–≤—ã–µ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é)

#### 5.1.1 –ü—Ä–æ—Ü–µ–¥—É—Ä–∞ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ø—Ä–∏ –∞–≤–∞—Ä–∏–∏
```bash
# 1. –ò–∑–º–µ–Ω–∏—Ç—å DNS –Ω–∞ DuckDNS
# –ó–∞–π—Ç–∏ –Ω–∞ https://www.duckdns.org/
# –ò–∑–º–µ–Ω–∏—Ç—å IP expensebot —Å 80.66.87.178 –Ω–∞ 72.56.67.202

# 2. –ù–∞ —Ä–µ–∑–µ—Ä–≤–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ (72.56.67.202) - –∑–∞–ø—É—Å—Ç–∏—Ç—å
ssh batman@72.56.67.202
cd /home/batman/expense_bot_deploy/expense_bot
docker compose start
docker compose ps

# 3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É (webhook –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –ù–ï –Ω—É–∂–Ω–æ!)
docker compose logs --tail=50 bot
```

#### 5.1.2 –í–æ–∑–≤—Ä–∞—Ç –Ω–∞ –æ—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–µ—Ä
```bash
# 1. –ù–∞ —Ä–µ–∑–µ—Ä–≤–Ω–æ–º - –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å
cd /home/batman/expense_bot_deploy/expense_bot
docker compose stop

# 2. –ò–∑–º–µ–Ω–∏—Ç—å DNS –æ–±—Ä–∞—Ç–Ω–æ –Ω–∞ 80.66.87.178 –Ω–∞ DuckDNS

# 3. –ù–∞ –æ—Å–Ω–æ–≤–Ω–æ–º - –∑–∞–ø—É—Å—Ç–∏—Ç—å
ssh batman@80.66.87.178
cd /home/batman/expense_bot
docker-compose start

# 4. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å webhook (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –±—ã–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã)
curl "https://api.telegram.org/bot8239680156:AAGe68TEXVcJzbcGaNA3YJGSb4lvpna349U/deleteWebhook"
curl "https://api.telegram.org/bot8239680156:AAGe68TEXVcJzbcGaNA3YJGSb4lvpna349U/setWebhook?url=https://expensebot.duckdns.org/webhook/"
```

### 5.2 –ö–æ–º–∞–Ω–¥—ã –¥–ª—è Nutrition Bot (—Ç—Ä–µ–±—É—é—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏)

#### 5.2.1 –ü–æ–ª–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–¥–∞ (–∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Nutrition Bot)
```bash
# –ü–æ–ª–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ —Ä–µ–∑–µ—Ä–≤–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ
cd /root/Nutrition_bot_v2 && \
git fetch --all && \
git reset --hard origin/master && \
git pull origin master && \
cd /root/Nutrition_bot_v2/deploy/app-server/ && \
docker-compose down && \
docker-compose build --no-cache && \
docker-compose up -d --force-recreate && \
docker image prune -f && \
docker container prune -f
```

#### 5.2.2 –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è —Å–∏—Å—Ç–µ–º—ã
```bash
# –ë—ã—Å—Ç—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (–∏–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞)
cd /root/Nutrition_bot_v2
./server_scripts/quick_check.sh

# –ü–æ–ª–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (–∏–∑ –∫–æ—Ä–Ω—è –ø—Ä–æ–µ–∫—Ç–∞)
./server_scripts/health_check.sh

# –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
cd /root/Nutrition_bot_v2/deploy/app-server/
docker-compose ps
docker-compose logs --tail=50 bot
```

### 5.3 –°–∫—Ä–∏–ø—Ç—ã —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏—è

#### 5.3.1 Backup —Å–∫—Ä–∏–ø—Ç –¥–ª—è Expense Bot
**–§–∞–π–ª:** `/mnt/c/Users/_batman_/Desktop/Nutrition_bot/nutrition_bot/server_scripts/expense_bot/backup_to_reserve.sh`

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
# –ù–∞ –æ—Å–Ω–æ–≤–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ
cd /home/batman/expense_bot
chmod +x scripts/backup_to_reserve.sh
bash scripts/backup_to_reserve.sh
# –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å –≤—ã–≤–µ–¥–µ–Ω–Ω—ã–π Timestamp (–Ω–∞–ø—Ä–∏–º–µ—Ä, 20240927_153012)
```

#### 5.3.2 Deploy —Å–∫—Ä–∏–ø—Ç –¥–ª—è —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
**–§–∞–π–ª:** `/mnt/c/Users/_batman_/Desktop/Nutrition_bot/nutrition_bot/server_scripts/expense_bot/deploy_on_reserve.sh`

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**
```bash
# –ù–∞ —Ä–µ–∑–µ—Ä–≤–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ
chmod +x /root/expense_bot/nutrition_bot/scripts/deploy_on_reserve.sh
bash /root/expense_bot/nutrition_bot/scripts/deploy_on_reserve.sh YYYYMMDD_HHMMSS
```

## 6. –ü—Ä–æ—Ü–µ–¥—É—Ä–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Nutrition Bot

### 6.1 –®–∞–≥ 1: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ WireGuard –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
```bash
# –ù–∞ DB —Å–µ—Ä–≤–µ—Ä–µ –¥–æ–±–∞–≤–∏—Ç—å –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –Ω–æ–≤–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
# Public Key: lt2Ih3Nx0mlHRp85VtJ1mqMeK1HkZk1YZZwYYqJMQGA=
# IP: 100.64.0.3/24

# –ù–∞ –Ω–æ–≤–æ–º —Ä–µ–∑–µ—Ä–≤–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ
sudo systemctl start wg-quick@wg0
sudo systemctl enable wg-quick@wg0
ping -c 3 100.64.0.1  # –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ DB
```

### 6.2 –®–∞–≥ 2: –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
```bash
# Nutrition Bot
cd /root
git clone https://github.com/sananlb/Nutrition_bot.git
cd Nutrition_bot_v2

# Expense Bot (–µ—Å–ª–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è)
cd /root
git clone https://github.com/batman-username/expense_bot.git
```

### 6.3 –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ .env —Ñ–∞–π–ª–æ–≤
```bash
# –ö–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ .env —Å –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
cd /root/Nutrition_bot_v2
# –°–æ–∑–¥–∞–Ω–∏–µ .env —Ñ–∞–π–ª–∞ —Å –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–º–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞–º–∏
```

### 6.4 –®–∞–≥ 4: –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π
```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ë–î
nc -zv 100.64.0.1 5432  # PostgreSQL
nc -zv 100.64.0.1 6379  # Redis

# –¢–µ—Å—Ç–æ–≤–∞—è —Å–±–æ—Ä–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤
cd deploy/app-server
docker-compose build --no-cache
```

## 7. –í—Ä–µ–º—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç—å

### 7.1 –í—Ä–µ–º—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏
- **Expense Bot:** ~1-2 –º–∏–Ω—É—Ç—ã (—Ç–æ–ª—å–∫–æ –æ–∂–∏–¥–∞–Ω–∏–µ DNS)
- **Nutrition Bot:** ~5-10 –º–∏–Ω—É—Ç (—Ç—Ä–µ–±—É–µ—Ç —Å–±–æ—Ä–∫–∏)

### 7.2 –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è webhook
–ü–æ—Å–ª–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Nginx –Ω–∞ —Ä–µ–∑–µ—Ä–≤–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ 29.09.2025:
- **–û—Å–Ω–æ–≤–Ω–æ–π —Å–µ—Ä–≤–µ—Ä:** webhook URL = `https://expensebot.duckdns.org/webhook/`
- **–†–µ–∑–µ—Ä–≤–Ω—ã–π —Å–µ—Ä–≤–µ—Ä:** webhook URL = `https://expensebot.duckdns.org/webhook/`
- **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –º–µ–∂–¥—É —Å–µ—Ä–≤–µ—Ä–∞–º–∏ webhook –ø–µ—Ä–µ—É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å –ù–ï –Ω—É–∂–Ω–æ!

## 8. –ß–µ–∫-–ª–∏—Å—Ç –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### 8.1 –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –∑–∞–¥–∞—á–∏ –¥–ª—è Nutrition Bot
- [ ] **–î–æ–±–∞–≤–∏—Ç—å –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á –Ω–∞ DB —Å–µ—Ä–≤–µ—Ä**
  - –ö–ª—é—á: `lt2Ih3Nx0mlHRp85VtJ1mqMeK1HkZk1YZZwYYqJMQGA=`
  - IP: `100.64.0.3/24`

- [ ] **–ö–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏**
  - Nutrition_bot_v2
  - expense_bot (–ø–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏)

- [ ] **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å .env —Ñ–∞–π–ª—ã**
  - –°–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å –æ—Å–Ω–æ–≤–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
  - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤—Å–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

- [ ] **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è**
  - WireGuard VPN
  - PostgreSQL
  - Redis

### 8.2 –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
- [ ] –°–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–æ–≤
- [ ] –ó–∞–ø—É—Å–∫ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤ –≤ —Ç–µ—Å—Ç–æ–≤–æ–º —Ä–µ–∂–∏–º–µ
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
- [ ] –î–µ–∞–∫—Ç–∏–≤–∞—Ü–∏—è —Å—Ç–∞—Ä–æ–≥–æ —Ä–µ–∑–µ—Ä–≤–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞

## 9. –ò—Ç–æ–≥–æ–≤—ã–π —Å—Ç–∞—Ç—É—Å

### ‚úÖ Expense Bot - –ü–û–õ–ù–û–°–¢–¨–Æ –ì–û–¢–û–í
- –†–∞–∑–≤–µ—Ä–Ω—É—Ç –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω –Ω–∞ —Ä–µ–∑–µ—Ä–≤–Ω–æ–º —Å–µ—Ä–≤–µ—Ä–µ
- –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞ (222 —Ç—Ä–∞—Ç—ã, 17 –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
- SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –∞–∫—Ç–∏–≤–µ–Ω –¥–æ 27.12.2025
- Nginx –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —É–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–∞ —Å –æ—Å–Ω–æ–≤–Ω—ã–º —Å–µ—Ä–≤–µ—Ä–æ–º
- Webhook URL –∏–¥–µ–Ω—Ç–∏—á–µ–Ω –æ—Å–Ω–æ–≤–Ω–æ–º—É —Å–µ—Ä–≤–µ—Ä—É (–ø–µ—Ä–µ—É—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è)
- **–í—Ä–µ–º—è –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ø—Ä–∏ —Å–±–æ–µ: ~1-2 –º–∏–Ω—É—Ç—ã (—Ç–æ–ª—å–∫–æ —Å–º–µ–Ω–∞ DNS)**

### ‚è≥ Nutrition Bot - –¢–†–ï–ë–£–ï–¢ –ù–ê–°–¢–†–û–ô–ö–ò
- Nginx –∏ SSL —É–∂–µ –≥–æ—Ç–æ–≤—ã (showmefood.duckdns.org)
- –¢—Ä–µ–±—É–µ—Ç—Å—è –∫–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
- –¢—Ä–µ–±—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ WireGuard –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ DB —Å–µ—Ä–≤–µ—Ä—É

### üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- Root –¥–æ—Å—Ç—É–ø –ø–æ SSH –æ—Ç–∫–ª—é—á–µ–Ω
- –î–æ—Å—Ç—É–ø —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è batman
- SSL —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã Let's Encrypt –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-09-29
**–ê–≤—Ç–æ—Ä:** Claude Code –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏ Nutrition_bot
**–ö–ª—é—á–µ–≤–æ–π —Å—Ç–∞—Ç—É—Å:** –†–µ–∑–µ—Ä–≤–Ω—ã–π —Å–µ—Ä–≤–µ—Ä 72.56.67.202 –≥–æ—Ç–æ–≤ –¥–ª—è —ç–∫—Å—Ç—Ä–µ–Ω–Ω–æ–≥–æ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è expense_bot. –î–ª—è –ø–æ–ª–Ω–æ–π –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ —Ç—Ä–µ–±—É–µ—Ç—Å—è –∑–∞–≤–µ—Ä—à–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫—É Nutrition_bot.